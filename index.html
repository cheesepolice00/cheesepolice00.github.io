<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CHEESE ê²½ì°°ì²­ í†µí•© ê¸°ë¡ì§€ - RP ì‹¤ì  ë° ë²Œê¸ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ">
  <title>CHEESE ê²½ì°°ì²­ í†µí•© ê¸°ë¡ì§€</title>
  <style>
    :root {
        --bg-color: #f0f2f5; --container-bg: #ffffff; --text-main: #333333; --text-sub: #666666;
        --border-color: #e1e4e8; --input-bg: #f8f9fa; --navbar-bg: #2c3e50;
        --accent-green: #27ae60; --accent-red: #e74c3c; --accent-blue: #3498db;
    }
    [data-theme="dark"] {
        --bg-color: #18191a; --container-bg: #242526; --text-main: #e4e6eb; --text-sub: #b0b3b8;
        --border-color: #3e4042; --input-bg: #3a3b3c; --navbar-bg: #1c1e21;
    }
    body { margin: 0; background-color: var(--bg-color); color: var(--text-main); font-family: 'Pretendard', sans-serif; transition: 0.3s; user-select: none; padding-bottom: 120px; }
    .navbar { background-color: var(--navbar-bg); padding: 0 20px; height: 60px; position: sticky; top: 0; z-index: 900; display: flex; justify-content: center; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .nav-links { display: flex; gap: 10px; }
    .nav-btn { background: transparent; color: #bdc3c7; border: none; padding: 10px 18px; font-weight: bold; cursor: pointer; border-radius: 12px; transition: 0.2s; font-size: 15px; }
    .nav-btn.active { background-color: rgba(255,255,255,0.15); color: #ffffff; }
    .theme-toggle { position: absolute; right: 20px; background: rgba(255,255,255,0.1); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 20px; display: flex; align-items: center; justify-content: center; color: white; transition: 0.3s; }
    
    .commute-panel { position: fixed; top: 75px; left: 20px; background: var(--container-bg); padding: 22px; border-radius: 18px; box-shadow: 0 8px 24px rgba(0,0,0,0.12); z-index: 800; width: 190px; border: 1px solid var(--border-color); }
    .commute-panel h4 { margin: 0 0 15px 0; text-align: center; font-size: 15px; color: var(--accent-blue); font-weight: 800; }
    .commute-input { width: 100%; padding: 14px; margin-bottom: 10px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--input-bg); color: var(--text-main); font-size: 15px; font-weight: bold; text-align: center; box-sizing: border-box; }
    .commute-btn { width: 100%; padding: 16px; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; color: white; transition: 0.2s; font-size: 16px; margin-top: 5px; }
    .btn-on { background: var(--accent-green); }
    .btn-off { background: var(--accent-red); }
    .btn-reset-all { background: #7f8c8d; font-size: 11px; padding: 10px; margin-top: 20px; opacity: 0.6; }

    .page-section { display: none; padding: 40px 20px 40px 250px; min-height: calc(100vh - 60px); justify-content: center; align-items: flex-start; }
    .page-section.active { display: flex; }
    .container-box { background: var(--container-bg); padding: 35px; border-radius: 20px; width: 100%; max-width: 680px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); border: 1px solid var(--border-color); }
    h2 { text-align: center; margin: 0 0 30px 0; font-weight: 800; }

    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 10px; font-size: 14px; font-weight: bold; color: var(--text-sub); }
    input, select, textarea { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border-color); background: var(--input-bg); color: var(--text-main); font-size: 16px; text-align: center; box-sizing: border-box; }
    .submit-btn { width: 100%; padding: 18px; border: none; border-radius: 12px; font-weight: bold; font-size: 17px; cursor: pointer; color: white; background: #333; transition: 0.2s; margin-top: 10px; }

    .tab-menu { display: flex; gap: 8px; margin-bottom: 20px; background: var(--input-bg); padding: 5px; border-radius: 14px; }
    .tab-btn { flex: 1; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; color: var(--text-sub); background: transparent; }
    .tab-btn.tab-active { background: var(--container-bg); color: var(--text-main); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .calc-list { max-height: 400px; overflow-y: auto; padding-right: 10px; }
    .item { display: flex; align-items: center; padding: 14px; background: var(--input-bg); border-radius: 12px; margin-bottom: 8px; cursor: pointer; font-size: 14px; border: 1px solid transparent; }
    .item:hover { border-color: var(--accent-blue); background: rgba(52, 152, 219, 0.05); }
    .item input { width: auto; margin-right: 15px; transform: scale(1.4); }
    .badge { margin-left: auto; font-weight: bold; color: var(--accent-red); font-size: 12px; padding: 4px 8px; background: rgba(231, 76, 60, 0.1); border-radius: 6px; }

    .sticky-result-bar { position: fixed; bottom: 0; left: 0; right: 0; background: var(--container-bg); border-top: 2px solid var(--border-color); padding: 15px 40px; display: none; justify-content: center; align-items: center; z-index: 1000; box-shadow: 0 -8px 25px rgba(0,0,0,0.1); }
    .result-content { display: flex; width: 100%; max-width: 1000px; align-items: center; justify-content: space-between; gap: 30px; }
    .result-info { display: flex; gap: 40px; align-items: center; }
    .info-box { display: flex; flex-direction: column; }
    .info-label { font-size: 12px; color: var(--text-sub); font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
    .info-value { font-size: 24px; font-weight: 900; }
    .info-value.money { color: var(--accent-red); }
    .bail-group { display: flex; align-items: center; background: var(--input-bg); padding: 10px 15px; border-radius: 12px; border: 2px solid var(--accent-blue); gap: 10px; }
    .bail-group input { width: 70px; padding: 5px; font-size: 16px; border: none; background: transparent; text-align: right; font-weight: 900; color: var(--accent-blue); }
    .action-btns { display: flex; gap: 12px; }
    .mini-btn { padding: 15px 25px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 15px; }
    .btn-reset { background: #95a5a6; color: white; }
    .btn-submit { background: var(--navbar-bg); color: white; min-width: 180px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
    .mudeo-btn { padding: 10px 15px !important; min-width: auto !important; }
    .mudeo-btn.mudeo-active { background: var(--accent-green) !important; color: white !important; box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3); }

    .radio-group { display: flex; gap: 12px; margin: 10px 0; }
    .radio-box { flex: 1; padding: 20px; border: 2px solid var(--border-color); border-radius: 14px; text-align: center; cursor: pointer; font-weight: bold; transition: 0.2s; color: var(--text-sub); }
    .radio-box.active-win { background: #eef9f1; border-color: var(--accent-green); color: var(--accent-green); }
    .radio-box.active-draw { background: #f0f8ff; border-color: #3498db; color: #3498db; }
    .radio-box.active-lose { background: #fff5f5; border-color: var(--accent-red); color: var(--accent-red); }

    .notice-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
    .notice-btn { padding: 12px; border: 1px solid var(--border-color); border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: bold; text-align: center; background: var(--input-bg); transition: 0.2s; }
    .notice-btn.selected { background: var(--accent-blue); color: white; border-color: var(--accent-blue); }

    .stats-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .stats-table th, .stats-table td { padding: 12px; text-align: center; border-bottom: 1px solid var(--border-color); }
    .stats-table th { background: var(--input-bg); font-weight: bold; color: var(--text-main); position: sticky; top: 0; }
    .stats-table tr:hover { background: rgba(52, 152, 219, 0.05); }
    .stats-table td { color: var(--text-main); }
    .week-selector { display: flex; gap: 10px; align-items: center; justify-content: center; margin-bottom: 20px; padding: 15px; background: var(--input-bg); border-radius: 12px; }
    .week-selector button { padding: 10px 20px; border: none; border-radius: 8px; background: var(--accent-blue); color: white; font-weight: bold; cursor: pointer; transition: 0.2s; }
    .week-selector button:hover { opacity: 0.8; }
    .week-display { font-weight: bold; font-size: 16px; color: var(--text-main); }

    @media (max-width: 1000px) { .page-section { padding-left: 20px; } .commute-panel { position: static; width: auto; margin-bottom: 20px; } .result-content { flex-direction: column; gap: 15px; } .sticky-result-bar { padding: 20px; } }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="nav-links">
      <button class="nav-btn active" onclick="switchPage('page-record', this)">ğŸ“ RP ì‹¤ì </button>
      <button class="nav-btn" onclick="switchPage('page-calc', this)">âš–ï¸ ë²Œê¸ˆ ê³„ì‚°ê¸°</button>
      <button class="nav-btn" onclick="switchPage('page-notice', this)">ğŸ“¢ ì‚¬ì´ë“œ ê³µì§€</button>
      <button class="nav-btn" onclick="checkAdminAccess(this)">ğŸ“Š ê´€ë¦¬</button>
    </div>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
  </nav>

  <div class="commute-panel">
    <h4>ê·¼ë¬´ ê´€ë¦¬</h4>
    <input type="text" id="c-uid" class="commute-input" placeholder="ê³ ìœ ë²ˆí˜¸" onchange="syncMyInfo()">
    <input type="text" id="c-name" class="commute-input" placeholder="ì„±í•¨" onchange="syncMyInfo()">
    <button id="c-btn" class="commute-btn btn-on" onclick="handleCommute()">ğŸ¢ ì¶œê·¼í•˜ê¸°</button>
    <button id="c-peak-btn" class="commute-btn btn-on" style="margin-top: 5px;" onclick="togglePeakMode()">âš¡ í”¼í¬ OFF</button>
    <button class="commute-btn btn-reset-all" onclick="resetAllData()">ğŸ”„ ì „ì²´ ì´ˆê¸°í™”</button>
  </div>

  <div id="page-record" class="page-section active">
    <div class="container-box">
      <h2>ğŸ“Š RP ì‹¤ì  ë“±ë¡</h2>
      <div class="form-group">
        <label>ë‚˜ì˜ ì •ë³´</label>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="r-uid" readonly placeholder="ê³ ë²ˆ">
          <input type="text" id="r-name" readonly placeholder="ì´ë¦„">
        </div>
      </div>
      <div class="form-group">
        <label>RP ì¢…ë¥˜</label>
        <select id="r-type">
          <option value="ATM">ATM ê°•ë„</option>
          <option value="í¸ì˜ì ">í¸ì˜ì  ê°•ë„</option>
          <option value="ë¹ˆì§‘í„¸ì´">ë¹ˆì§‘í„¸ì´</option>
          <option value="ë‚¨ë¶€ì€í–‰">ë‚¨ë¶€ì€í–‰</option>
          <option value="ë³´ì„ìƒ">ë³´ì„ìƒ</option>
          <option value="ê²½ì°°ì„œ í„¸ì´1ì°¨">ê²½ì°°ì„œ í„¸ì´1ì°¨</option>
          <option value="ê²½ì°°ì„œ í„¸ì´2ì°¨">ê²½ì°°ì„œ í„¸ì´2ì°¨</option>
          <option value="ë„ì£¼">ë„ì£¼</option>
          <option value="ì¦‰í¥">ì¦‰í¥</option>
          <option value="ìˆ˜ë°°">ìˆ˜ë°°</option>
          <option value="ì˜ì¥">ì˜ì¥</option>
        </select>
      </div>
      <div class="form-group">
        <label>ê²°ê³¼ ì„ íƒ</label>
        <div class="radio-group">
          <div class="radio-box" id="box-win" onclick="setResult('ìŠ¹ë¦¬')">ğŸ† ìŠ¹ë¦¬</div>
          <div class="radio-box" id="box-draw" onclick="setResult('ë¬´ìŠ¹ë¶€')">ğŸ¤ ë¬´ìŠ¹ë¶€</div>
          <div class="radio-box" id="box-lose" onclick="setResult('íŒ¨ë°°')">âŒ íŒ¨ë°°</div>
        </div>
      </div>
      <button id="r-submit-btn" class="submit-btn" style="background: #34495e;" onclick="submitRp()">ì‹¤ì  ì‹œíŠ¸ì— ë“±ë¡í•˜ê¸°</button>
    </div>
  </div>

  <div id="page-calc" class="page-section">
    <div class="container-box">
      <h2>âš–ï¸ ê²½ì°°ì²­ ë²Œê¸ˆ ê³„ì‚°ê¸°</h2>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; padding: 20px; background: var(--input-bg); border-radius: 16px;">
        <input type="text" id="f-sus-uid" placeholder="ë²”ì£„ì ê³ ë²ˆ">
        <input type="text" id="f-sus-name" placeholder="ë²”ì£„ì ì´ë¦„">
      </div>
      <div class="tab-menu">
        <button class="tab-btn tab-active" onclick="openCalcTab(event, 'tab-traffic')">ğŸš¦ êµí†µ</button>
        <button class="tab-btn" onclick="openCalcTab(event, 'tab-story')">ğŸ”« ìŠ¤í† ë¦¬</button>
        <button class="tab-btn" onclick="openCalcTab(event, 'tab-strong')">ğŸ•‹ ê³µë¬´ì›</button>
      </div>

      <div id="tab-traffic" class="calc-list" style="display: block;">
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ì‹ í˜¸ ìœ„ë°˜</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ì†ë„ ìœ„ë°˜</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ì—­ì£¼í–‰</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ì°¨ì„  ìœ„ë°˜</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ì¤‘ì•™ì„  ì¹¨ë²”</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ìŠ¤í„´íŠ¸</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="15000000" data-time="0" onchange="calc()"> ë³´ë³µ ìš´ì „</label><span class="badge">$15,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ì¸ë„ ì£¼í–‰</label><span class="badge">$10,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ê³µê³µê¸°ë¬¼ íŒŒì†</label><span class="badge">$10,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="12000000" data-time="0" onchange="calc()"> ë¶ˆë²• ìœ í„´</label><span class="badge">$12,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ì†ŒìŒ ê³µí•´</label><span class="badge">$10,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="20" onchange="calc()"> í­ ì£¼</label><span class="badge">$30,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="17000000" data-time="10" onchange="calc()"> ìŒì£¼ ìš´ì „</label><span class="badge">$17,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ìŠ¹ì°¨ ë°©ë²• ì œí•œ</label><span class="badge">$10,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ìš´ì „ì¤‘ í•¸ë“œí° ì‚¬ìš©</label><span class="badge">$10,000,000</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="10000000" data-time="0" onchange="calc()"> ë¹„ì •ìƒ ë„ë¡œ ì§„ì…</label><span class="badge">$10,000,000</span></div>
      </div>

      <div id="tab-story" class="calc-list" style="display: none;">
        <div class="item" onclick="handleStoryClick(this, 'ATM')"><label><input type="checkbox" class="calc-check" data-money="100000000" data-time="10"> ATM</label><span class="badge">$100,000,000 / 10ë¶„</span></div>
        <div class="item" onclick="handleStoryClick(this, 'í¸ì˜ì ')"><label><input type="checkbox" class="calc-check" data-money="100000000" data-time="15"> í¸ì˜ì </label><span class="badge">$100,000,000 / 15ë¶„</span></div>
        <div class="item" onclick="handleStoryClick(this, 'ë¹ˆì§‘ í„¸ì´')"><label><input type="checkbox" class="calc-check" data-money="100000000" data-time="15"> ë¹ˆì§‘ í„¸ì´</label><span class="badge">$100,000,000 / 15ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="150000000" data-time="30" onchange="calc()"> ë‚¨ë¶€ ì€í–‰</label><span class="badge">$150,000,000 / 30ë¶„</span></div>
        <div class="item" onclick="handleStoryClick(this, 'ë³´ì„ìƒ')"><label><input type="checkbox" class="calc-check" data-money="150000000" data-time="20"> ë³´ì„ìƒ</label><span class="badge">$150,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="200000000" data-time="30" onchange="calc()"> ê²½ì°°ì„œ í„¸ì´ 1ì°¨</label><span class="badge">$200,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="200000000" data-time="30" onchange="calc()"> ê²½ì°°ì„œ í„¸ì´ 2ì°¨</label><span class="badge">$200,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="200000000" data-time="30" onchange="calc()"> ì¦‰í¥</label><span class="badge">$200,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="200000000" data-time="30" onchange="calc()"> ì˜ì¥</label><span class="badge">$200,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="300000000" data-time="30" onchange="calc()"> ìˆ˜ë°°</label><span class="badge">$300,000,000 / 30ë¶„</span></div>
      </div>
      <div id="mudeo-panel" style="display: none; margin-top: 20px; padding: 15px; background: var(--input-bg); border-radius: 12px;">
        <div style="font-weight: bold; margin-bottom: 12px; color: var(--accent-blue);">ë¬»ë” ì„ íƒ:</div>
        <button class="mini-btn mudeo-btn" id="mudeo-btn-1" style="background: var(--accent-blue); color: white; margin-right: 8px; margin-bottom: 8px;" onclick="applyMudeo('mudeo1')">ë¬»ë”</button>
        <button class="mini-btn mudeo-btn" id="mudeo-btn-2" style="background: var(--accent-blue); color: white; margin-right: 8px; margin-bottom: 8px;" onclick="applyMudeo('mudeo2')">ë¬»ë¬»ë”</button>
        <button class="mini-btn mudeo-btn" id="mudeo-btn-3" style="background: var(--accent-blue); color: white; margin-bottom: 8px;" onclick="applyMudeo('mudeo3')">ë¬»ë¬»ë¬»ë”</button>
      </div>

      <div id="tab-strong" class="calc-list" style="display: none;">
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="50000000" data-time="20" onchange="calc()"> ì‹œë¯¼ ì‚´ì¸</label><span class="badge">$50,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="70000000" data-time="30" onchange="calc()"> ê³µë¬´ì› ì‚´ì¸</label><span class="badge">$70,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="20" onchange="calc()"> ì‹œë¯¼ ì‚´ì¸ ë¯¸ìˆ˜</label><span class="badge">$30,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="50000000" data-time="30" onchange="calc()"> ê³µë¬´ì› ì‚´ì¸ ë¯¸ìˆ˜</label><span class="badge">$50,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="20000000" data-time="15" onchange="calc()"> ì‹œë¯¼ í­í–‰</label><span class="badge">$20,000,000 / 15ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="40000000" data-time="20" onchange="calc()"> ê³µë¬´ì› í­í–‰</label><span class="badge">$40,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="60000000" data-time="25" onchange="calc()"> ê³µë¬´ì› ë‹¨ì²´ í­í–‰</label><span class="badge">$60,000,000 / 25ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="20000000" data-time="20" onchange="calc()"> ì‹œë¯¼ ì°¨ëŸ‰ ì ˆë„</label><span class="badge">$20,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="40000000" data-time="30" onchange="calc()"> ê³µë¬´ì› ì°¨ëŸ‰ ì ˆë„</label><span class="badge">$40,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="10" onchange="calc()"> ê³µë¬´ì› ì¬ë¬¼ ì†ê´´</label><span class="badge">$30,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="60000000" data-time="10" onchange="calc()"> ì‹œë¯¼ ë‚©ì¹˜</label><span class="badge">$60,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="30" onchange="calc()"> ë¶ˆë²•ë¬¼í’ˆ ë° ë¬´ê¸° ì†Œì§€</label><span class="badge">$30,000,000 / 30ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="15000000" data-time="10" onchange="calc()"> íš¡ë ¹ ë° ì‚¬ê¸°</label><span class="badge">$15,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="40000000" data-time="25" onchange="calc()"> ê³µë¬´ì› ì‚¬ì¹­</label><span class="badge">$40,000,000 / 25ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="20000000" data-time="20" onchange="calc()"> í—ˆìœ„ì‚¬ì‹¤ ìœ í¬</label><span class="badge">$20,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="20" onchange="calc()"> ê±°ì§“ì§„ìˆ </label><span class="badge">$30,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="20000000" data-time="10" onchange="calc()"> ì‚¬ìœ ì§€ ë¬´ë‹¨ ì¹¨ì…</label><span class="badge">$20,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="20" onchange="calc()"> ê³µë¬´ì› ê±°ì§“ í˜¸ì¶œ</label><span class="badge">$30,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="10" onchange="calc()"> ì§‘í–‰ì¤‘ ë„ì£¼</label><span class="badge">$30,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="30000000" data-time="15" onchange="calc()"> ê³µë¬´ì§‘í–‰ ë°©í•´</label><span class="badge">$30,000,000 / 15ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="40000000" data-time="10" onchange="calc()"> ê³µë¬´ ì§€ì‹œ ë¶ˆì´í–‰</label><span class="badge">$40,000,000 / 10ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="70000000" data-time="20" onchange="calc()"> ê³µë¬´ ì§€ì‹œ ë¶ˆì´í–‰ ë„ì£¼</label><span class="badge">$70,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="60000000" data-time="40" onchange="calc()"> ê³µë¬´ì› ë‡Œë¬¼ ìˆ˜ìˆ˜</label><span class="badge">$60,000,000 / 40ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="40000000" data-time="20" onchange="calc()"> ê³µë¬´ì› ëª…ì˜ˆí›¼ì†</label><span class="badge">$40,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="25000000" data-time="20" onchange="calc()"> ì¦ê±° ì¸ë©¸</label><span class="badge">$25,000,000 / 20ë¶„</span></div>
        <div class="item"><label><input type="checkbox" class="calc-check" data-money="20000000" data-time="10" onchange="calc()"> ìŠ¤í† í‚¹</label><span class="badge">$20,000,000 / 10ë¶„</span></div>
      </div>

      <div id="selected-items-display" style="padding: 20px; margin-top: 25px; background: var(--input-bg); border-radius: 14px; border: 2px solid var(--border-color); cursor: pointer; transition: 0.2s;" onclick="copySelectedItems()" onmouseover="this.style.borderColor='var(--accent-blue)'" onmouseout="this.style.borderColor='var(--border-color)'">
        <div style="font-weight: bold; margin-bottom: 8px; font-size: 14px; color: var(--text-main);">ğŸ“‹ ì„ íƒëœ ì£„ëª© (í´ë¦­í•˜ì—¬ ë³µì‚¬)</div>
        <div id="selected-items-text" style="font-size: 14px; color: var(--text-sub); line-height: 1.6;">ì—†ìŒ</div>
      </div>
    </div>
  </div>

  <div id="calc-sticky-bar" class="sticky-result-bar">
    <div class="result-content">
      <div class="result-info">
        <div class="info-box"><span class="info-label">ì´ ë²Œê¸ˆ</span><span class="info-value money">$<span id="disp-money">0</span></span></div>
        <div class="info-box"><span class="info-label">êµ¬ê¸ˆ ì‹œê°„</span><span class="info-value"><span id="disp-time">0</span>ë¶„</span></div>
        <div class="info-box"><span class="info-label">ë³´ì„ê¸ˆ ê°ë©´</span><div class="bail-group"><input type="number" id="f-bail-time" value="0" min="0" oninput="onBailInputChange()"><span style="font-size: 14px; font-weight: 900;">ë¶„</span></div></div>
      </div>
      <div class="action-btns">
        <button class="mini-btn btn-reset" onclick="resetCalc()">ğŸ”„ ì´ˆê¸°í™”</button>
        <button id="submit-fine-btn" class="mini-btn btn-submit" onclick="submitFine()">ğŸ“Š ë²Œê¸ˆ ì‹œíŠ¸ì— ë“±ë¡</button>
      </div>
    </div>
  </div>

  <div id="page-notice" class="page-section">
    <div class="container-box">
      <h2>ğŸ“¢ ì‚¬ì´ë“œ ê³µì§€ ìƒì„±ê¸°</h2>
      <div id="notice-grid" class="notice-grid"></div>
      <div id="notice-input-section" style="display: none; margin-top: 20px; padding: 15px; background: var(--input-bg); border-radius: 12px; margin-bottom: 20px;">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
          <input type="text" id="notice-uid" placeholder="ê³ ìœ ë²ˆí˜¸" onchange="updateNoticePreview()" style="padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--container-bg); color: var(--text-main); font-size: 14px;">
          <input type="text" id="notice-name" placeholder="ë‹‰ë„¤ì„" onchange="updateNoticePreview()" style="padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--container-bg); color: var(--text-main); font-size: 14px;">
        </div>
      </div>
      <textarea id="notice-preview" style="height: 350px; text-align: left; padding: 20px; line-height: 1.6; margin-top:20px; font-weight: bold; font-family: 'Pretendard', sans-serif;"></textarea>
      <button class="submit-btn" style="background: var(--accent-blue);" onclick="copyNotice()">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
    </div>
  </div>

  <div id="page-admin" class="page-section">
    <div class="container-box" style="max-width: 900px;">
      <h2>ğŸ“Š ì£¼ê°„ ì‹¤ì  ê´€ë¦¬</h2>
      <div class="week-selector">
        <button onclick="changeWeek(-1)">â—€ ì´ì „ ì£¼</button>
        <span class="week-display" id="week-display">ë¡œë”© ì¤‘...</span>
        <button onclick="changeWeek(1)">ë‹¤ìŒ ì£¼ â–¶</button>
      </div>
      <div id="loading-message" style="text-align: center; padding: 40px; color: var(--text-sub);">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
      <div id="stats-container" style="display: none; overflow-x: auto;">
        <table class="stats-table">
          <thead>
            <tr>
              <th>ê³ ìœ ë²ˆí˜¸</th>
              <th>ì´ë¦„</th>
              <th>ì´ ê·¼ë¬´ì‹œê°„</th>
              <th>RPìŠ¹ë¦¬</th>
              <th>ì´ RPíšŸìˆ˜</th>
              <th>ì´ ë²Œê¸ˆ ë¶€ê³¼ì•¡</th>
            </tr>
          </thead>
          <tbody id="stats-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // âš ï¸ êµ¬ê¸€ ì›¹ ì•± URLì„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxh7IP0O40X5XwkVHIbMtJkF8VuS64NZqN8kDIJPkIhN7XWqq8-OFwr9o4mlrPnKhnd/exec"; 
    let selectedRes = "";
    let selectedStory = null;
    let selectedNotice = null;
    let selectedMudeo = null;
    let isPeakMode = false;
    let isManualBailInput = false;

    // ë¬»ë” ê´€ë ¨ ë²Œê¸ˆí‘œ ë°ì´í„°
    const mudeoData = {
      'ATM': {
        mudeo1: { baseMoney: 200000000, baseTime: 20, bailMoney: 210000000, bailTime: 10, bailPeak: 210500000, bailPeakTime: 5 },
        mudeo2: { baseMoney: 300000000, baseTime: 30, bailMoney: 310000000, bailTime: 10, bailPeak: 312500000, bailPeakTime: 5 },
        mudeo3: { baseMoney: 400000000, baseTime: 40, bailMoney: null, bailTime: null, bailPeak: null, bailPeakTime: null }
      },
      'í¸ì˜ì ': {
        mudeo1: { baseMoney: 200000000, baseTime: 30, bailMoney: 210000000, bailTime: 10, bailPeak: 212500000, bailPeakTime: 5 },
        mudeo2: { baseMoney: 300000000, baseTime: 45, bailMoney: 310000000, bailTime: 10, bailPeak: 312500000, bailPeakTime: 5 },
        mudeo3: { baseMoney: 400000000, baseTime: 60, bailMoney: null, bailTime: null, bailPeak: null, bailPeakTime: null }
      },
      'ë¹ˆì§‘ í„¸ì´': {
        mudeo1: { baseMoney: 200000000, baseTime: 30, bailMoney: 210000000, bailTime: 10, bailPeak: 212500000, bailPeakTime: 5 },
        mudeo2: { baseMoney: 300000000, baseTime: 45, bailMoney: 310000000, bailTime: 10, bailPeak: 312500000, bailPeakTime: 5 },
        mudeo3: { baseMoney: 400000000, baseTime: 60, bailMoney: null, bailTime: null, bailPeak: null, bailPeakTime: null }
      },
      'ë³´ì„ìƒ': {
        mudeo1: { baseMoney: 300000000, baseTime: 40, bailMoney: 310000000, bailTime: 10, bailPeak: 312500000, bailPeakTime: 5 },
        mudeo2: { baseMoney: 450000000, baseTime: 60, bailMoney: 460000000, bailTime: 10, bailPeak: 462500000, bailPeakTime: 5 },
        mudeo3: { baseMoney: 600000000, baseTime: 80, bailMoney: null, bailTime: null, bailPeak: null, bailPeakTime: null }
      }
    };

    function handleStoryClick(element, storyType) {
      const isApplicable = ['ATM', 'í¸ì˜ì ', 'ë¹ˆì§‘ í„¸ì´', 'ë³´ì„ìƒ'].includes(storyType);
      const checkbox = element.querySelector('.calc-check');
      
      // ë‹¤ë¥¸ ìŠ¤í† ë¦¬ ì²´í¬ í•´ì œ
      document.querySelectorAll('#tab-story .calc-check').forEach(c => {
        if(c !== checkbox) c.checked = false;
      });
      
      // ì²´í¬ë°•ìŠ¤ í† ê¸€
      checkbox.checked = !checkbox.checked;
      
      if(isApplicable && checkbox.checked) {
        selectedStory = storyType;
        selectedMudeo = null;
        document.getElementById('mudeo-panel').style.display = 'block';
        document.querySelectorAll('.mudeo-btn').forEach(btn => btn.classList.remove('mudeo-active'));
      } else {
        selectedStory = null;
        selectedMudeo = null;
        document.getElementById('mudeo-panel').style.display = 'none';
      }
      
      // ê¸°ë³¸ ê°’ìœ¼ë¡œ ê³„ì‚°
      calc();
    }

    function applyMudeo(mudeoType) {
      if(!selectedStory) return alert("ìŠ¤í† ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.");
      
      // ê°™ì€ ë²„íŠ¼ì„ ë‹¤ì‹œ í´ë¦­í•˜ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›
      if(selectedMudeo === mudeoType) {
        // ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›
        const defaultValues = {
          'ATM': { money: 100000000, time: 10 },
          'í¸ì˜ì ': { money: 100000000, time: 15 },
          'ë¹ˆì§‘ í„¸ì´': { money: 100000000, time: 15 },
          'ë³´ì„ìƒ': { money: 150000000, time: 20 }
        };
        
        const storyCheckbox = Array.from(document.querySelectorAll('#tab-story .calc-check')).find(c => 
          c.parentElement.innerText.includes(selectedStory)
        );
        
        if(storyCheckbox && defaultValues[selectedStory]) {
          storyCheckbox.dataset.money = defaultValues[selectedStory].money;
          storyCheckbox.dataset.time = defaultValues[selectedStory].time;
        }
        
        document.querySelectorAll('.mudeo-btn').forEach(btn => btn.classList.remove('mudeo-active'));
        selectedMudeo = null;
        document.getElementById('f-bail-time').value = 0;
        isManualBailInput = false;
        calc();
        return;
      }
      
      const data = mudeoData[selectedStory][mudeoType];
      if(!data) return;

      // ê¸°ì¡´ ì²´í¬ë°•ìŠ¤ ëª¨ë‘ í•´ì œ
      document.querySelectorAll('.calc-check').forEach(c => c.checked = false);
      
      // ìŠ¤í† ë¦¬ í•­ëª© ë‹¤ì‹œ ì²´í¬
      const storyCheckbox = Array.from(document.querySelectorAll('#tab-story .calc-check')).find(c => 
        c.parentElement.innerText.includes(selectedStory)
      );
      if(storyCheckbox) storyCheckbox.checked = true;
      
      // ë°ì´í„° ì†ì„± ì—…ë°ì´íŠ¸
      if(storyCheckbox) {
        storyCheckbox.dataset.money = data.baseMoney;
        storyCheckbox.dataset.time = data.baseTime;
      }
      
      // ë¬»ë¬»ë”(mudeo2), ë¬»ë¬»ë¬»ë”(mudeo3)ëŠ” ë³´ì„ê¸ˆ ê°ë©´ 0ìœ¼ë¡œ ì„¤ì •
      if(mudeoType === 'mudeo2' || mudeoType === 'mudeo3') {
        document.getElementById('f-bail-time').value = 0;
        isManualBailInput = true;
      } else {
        isManualBailInput = false;
      }
      
      // ë³´ì„ê¸ˆ ì˜µì…˜ ì—…ë°ì´íŠ¸ (ì„ íƒ ì‚¬í•­)
      localStorage.setItem('mudeoType', mudeoType);
      localStorage.setItem('mudeoMoney', data.baseMoney);
      localStorage.setItem('mudeoTime', data.baseTime);
      
      // í˜„ì¬ ì„ íƒëœ ë¬»ë” ì €ì¥
      selectedMudeo = mudeoType;
      
      // ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
      document.querySelectorAll('.mudeo-btn').forEach(btn => btn.classList.remove('mudeo-active'));
      const buttonMap = { 'mudeo1': 'mudeo-btn-1', 'mudeo2': 'mudeo-btn-2', 'mudeo3': 'mudeo-btn-3' };
      document.getElementById(buttonMap[mudeoType]).classList.add('mudeo-active');
      
      calc();
    } 

    function getNoticeTemplates() {
        const name = localStorage.getItem('myName') || "ë¯¸ì…ë ¥";
        const uid = localStorage.getItem('myUid') || "ë¯¸ì…ë ¥";
        const inputName = document.getElementById('notice-name')?.value || name;
        const inputUid = document.getElementById('notice-uid')?.value || uid;
        const attendanceTime = getAttendanceTime();
        const currentTime = getCurrentTime();
        const attendanceTime30 = getAttendanceTime30();
        
        return {
            "ì¶œì„ ê³µì§€": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤. ${inputName}(${inputUid})ë‹˜ ${attendanceTime} ê¹Œì§€ ê²½ì°°ì²­ ì‚¬ìœ ì§€ë¡œ ì¶œì„ ë°”ëë‹ˆë‹¤. - ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "ìˆ˜ë°° ê³µì§€": `/íŒ©ì…˜ê³µì§€\në‹‰ë„¤ì„ : ${inputName}\nê³ ìœ ë²ˆí˜¸ : ${inputUid}\ní˜„ì¬ì‹œê°: ${currentTime} ~ ${attendanceTime30} (30ë¶„)\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "ê²½í„¸1ì°¨": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\në‚¨ë¶€ ê²½ì°°ì²­ ì„œë²„ì‹¤ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ ì„œë²„ì‹¤ ìœ„ì¹˜ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "ê²½í„¸2ì°¨": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n217ë²ˆì§€ ê²½ì°°ì²­ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 217ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤..\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "697": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n697ë²ˆì§€ ë³´ì„ìƒì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 697ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "575": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n575ë²ˆì§€ ë‚¨ë¶€ì€í–‰ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 575ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "692": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n692ë²ˆì§€ ë¹ˆì§‘ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 692ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "574": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n574ë²ˆì§€ í¸ì˜ì ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 574ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "449": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n449ë²ˆì§€ í¸ì˜ì ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 449ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "333": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n333ë²ˆì§€ í¸ì˜ì ì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 333ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "584": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n584ë²ˆì§€ ATMì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 584ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
            "206": `/íŒ©ì…˜ê³µì§€ ì¹˜ì¦ˆ ê²½ì°°ì²­ì—ì„œ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.\n206ë²ˆì§€ ATMì—ì„œ ê°•ë„ ë°œìƒìœ¼ë¡œ 206ë²ˆì§€ë¡œë¶€í„° 2ë¸”ëŸ­ ì´ë‚´ ì ‘ê·¼ ì‹œ ê²½ê³  ì—†ì´ ë¬´í†µë³´ ì‚¬ì‚´ë¨ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n- ì¹˜ì¦ˆ ê²½ì°°ì²­ -`,
        };
    }

    function getAttendanceTime() {
        const now = new Date();
        now.setMinutes(now.getMinutes() + 5);
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        return `${hours}ì‹œ${minutes}ë¶„`;
    }

    function getAttendanceTime30() {
        const now = new Date();
        now.setMinutes(now.getMinutes() + 30);
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        return `${hours}ì‹œ${minutes}ë¶„`;
    }

    function getCurrentTime() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        return `${hours}ì‹œ${minutes}ë¶„`;
    }

    function renderNotices() {
        const g = document.getElementById('notice-grid'); g.innerHTML = "";
        const templates = getNoticeTemplates();
        for(let k in templates) {
            let b = document.createElement('div'); b.className='notice-btn'; b.innerText=k;
            b.onclick=()=>{ 
                document.querySelectorAll('.notice-btn').forEach(x=>x.classList.remove('selected')); 
                b.classList.add('selected'); 
                
                // í˜„ì¬ ì„ íƒëœ ê³µì§€ ì €ì¥
                selectedNotice = k;
                
                // ì¶œì„ ê³µì§€ ë˜ëŠ” ìˆ˜ë°° ê³µì§€ì¼ ë•Œ ì…ë ¥ì¹¸ í‘œì‹œ
                const inputSection = document.getElementById('notice-input-section');
                if(k === 'ì¶œì„ ê³µì§€' || k === 'ìˆ˜ë°° ê³µì§€') {
                    inputSection.style.display = 'block';
                    document.getElementById('notice-uid').value = localStorage.getItem('myUid') || '';
                    document.getElementById('notice-name').value = localStorage.getItem('myName') || '';
                } else {
                    inputSection.style.display = 'none';
                }
                
                updateNoticePreview();
            };
            g.appendChild(b);
        }
    }

    function updateNoticePreview() {
        if(!selectedNotice) return;
        const templates = getNoticeTemplates();
        if(templates[selectedNotice]) {
            document.getElementById('notice-preview').value = templates[selectedNotice];
        }
    }

    function checkAdminAccess(btn) {
        const isAuthenticated = sessionStorage.getItem('adminAuth') === 'true';
        
        if(isAuthenticated) {
            switchPage('page-admin', btn);
            return;
        }
        
        const password = prompt('ê´€ë¦¬ í˜ì´ì§€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
        
        if(password === '15411541') {
            sessionStorage.setItem('adminAuth', 'true');
            switchPage('page-admin', btn);
        } else if(password !== null) {
            alert('âŒ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }
    }

    function switchPage(id, btn) {
        document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('calc-sticky-bar').style.display = (id === 'page-calc' ? 'flex' : 'none');
        
        // ê´€ë¦¬ í˜ì´ì§€ ì ‘ê·¼ ì‹œ ë°ì´í„° ë¡œë“œ
        if(id === 'page-admin' && !weeklyData) {
          loadWeeklyStats();
        }
    }

    function updateSelectedItemsDisplay() {
      let items = [];
      document.querySelectorAll('.calc-check:checked').forEach(c => {
        items.push(c.parentElement.innerText.split('$')[0].trim());
      });
      
      const displayText = items.length > 0 ? items.join(', ') : 'ì—†ìŒ';
      document.getElementById('selected-items-text').innerText = displayText;
    }

    function copySelectedItems() {
      const text = document.getElementById('selected-items-text').innerText;
      if(text === 'ì—†ìŒ') {
        alert('ì„ íƒëœ ì£„ëª©ì´ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }

      const fallbackCopy = () => {
        const temp = document.createElement('textarea');
        temp.value = text;
        document.body.appendChild(temp);
        temp.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(temp);
        if(!ok) throw new Error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨');
      };

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text)
        .then(()=>alert("ì„ íƒëœ ì£„ëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"))
        .catch(() => { fallbackCopy(); alert("ì„ íƒëœ ì£„ëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"); });
      } else {
        try { fallbackCopy(); alert("ì„ íƒëœ ì£„ëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"); }
        catch(e) { alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message); }
      }
    }

    function calc() {
      let baseMoney = 0, baseTime = 0;
      document.querySelectorAll('.calc-check:checked').forEach(c => { baseMoney += parseInt(c.dataset.money, 10); baseTime += parseInt(c.dataset.time, 10); });

      updateSelectedItemsDisplay();

      let bailInput = parseInt(document.getElementById('f-bail-time').value, 10) || 0;
      
      // í”¼í¬ ëª¨ë“œì¼ ë•Œ ìë™ìœ¼ë¡œ ë³´ì„ê¸ˆ ê°ë©´ ê³„ì‚° (ìˆ˜ë™ ì…ë ¥ì´ ì•„ë‹ ë•Œë§Œ)
      if(isPeakMode && !isManualBailInput) {
        // ATM ì²´í¬ ì—¬ë¶€ í™•ì¸
        const isATMChecked = Array.from(document.querySelectorAll('#tab-story .calc-check:checked')).some(c => 
          c.parentElement.innerText.includes('ATM')
        );
        
        if(isATMChecked && baseTime >= 10) {
          // ATMì€ 0ë¶„ìœ¼ë¡œ ë§Œë“¤ê¸° ìœ„í•´ ì „ì²´ ì‹œê°„ ê°ë©´
          bailInput = baseTime;
        } else if(baseTime > 5) {
          // ë‹¤ë¥¸ ê²½ìš°ëŠ” 5ë¶„ê¹Œì§€ë§Œ ê°ë©´
          bailInput = baseTime - 5;
        }
        document.getElementById('f-bail-time').value = bailInput;
      }
      
      const bail = baseTime > 0 ? bailInput : 0; // ë³´ì„ì€ êµ¬ê¸ˆ ì‹œê°„ì´ ìˆì„ ë•Œë§Œ ì ìš©

      let money = baseMoney;
      let time = baseTime;

      if (bail > 0) {
        money += bail * 500000;
        time = Math.max(0, baseTime - bail);
      }

      if (baseTime >= 5) time = Math.max(5, time); else time = Math.max(0, time);
      
      // ATMì´ê³  í”¼í¬ëª¨ë“œì¼ ë•ŒëŠ” 0ë¶„ í—ˆìš©
      if(isPeakMode && Array.from(document.querySelectorAll('#tab-story .calc-check:checked')).some(c => c.parentElement.innerText.includes('ATM'))) {
        time = Math.max(0, baseTime - bail);
      }

      document.getElementById('disp-money').innerText = money.toLocaleString();
      document.getElementById('disp-time').innerText = time;
    }

    function onBailInputChange() {
      isManualBailInput = true;
      calc();
    }

    function resetCalc() { 
      document.querySelectorAll('.calc-check').forEach(c => c.checked = false); 
      document.getElementById('f-bail-time').value = 0; 
      isManualBailInput = false;
      calc(); 
    }

    function togglePeakMode() {
      isPeakMode = !isPeakMode;
      isManualBailInput = false;
      const btn = document.getElementById('c-peak-btn');
      if(isPeakMode) {
        btn.innerText = 'âš¡ í”¼í¬ ON';
        btn.style.background = 'var(--accent-red)';
        localStorage.setItem('isPeakMode', 'true');
      } else {
        btn.innerText = 'âš¡ í”¼í¬ OFF';
        btn.style.background = 'var(--accent-green)';
        localStorage.setItem('isPeakMode', 'false');
        // í”¼í¬ OFF ì‹œ ë³´ì„ê¸ˆ ê°ë©´ 0ìœ¼ë¡œ ì´ˆê¸°í™”
        document.getElementById('f-bail-time').value = 0;
      }
      calc();
    }

    function openCalcTab(e, id) {
        document.querySelectorAll('.calc-list').forEach(l => l.style.display = 'none');
        document.getElementById(id).style.display = 'block';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('tab-active'));
        e.currentTarget.classList.add('tab-active');
        
        // tab-storyê°€ ì•„ë‹Œ ë‹¤ë¥¸ íƒ­ìœ¼ë¡œ ì´ë™í•˜ë©´ mudeo-panel ìˆ¨ê¸°ê¸°
        if(id !== 'tab-story') {
          document.getElementById('mudeo-panel').style.display = 'none';
          selectedStory = null;
          selectedMudeo = null;
          document.querySelectorAll('#tab-story .calc-check').forEach(c => c.checked = false);
          calc();
        } else {
          // tab-storyë¥¼ ì—´ ë•Œë§Œ mudeo-panel ì´ˆê¸°í™”
          document.getElementById('mudeo-panel').style.display = 'none';
          selectedStory = null;
          selectedMudeo = null;
          document.querySelectorAll('#tab-story .calc-check').forEach(c => c.checked = false);
          calc();
        }
    }

    function syncMyInfo() {
        const u = document.getElementById('c-uid').value, n = document.getElementById('c-name').value;
        localStorage.setItem('myUid', u); localStorage.setItem('myName', n);
        document.getElementById('r-uid').value = u; document.getElementById('r-name').value = n;
        renderNotices();
    }

    function submitRp() {
        const u = localStorage.getItem('myUid'), n = localStorage.getItem('myName');
        const btn = document.getElementById('r-submit-btn');
        if(!u || !n) return alert("ë³¸ì¸ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        if(!selectedRes) return alert("ìŠ¹íŒ¨ ê²°ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”.");

        btn.disabled = true;
        const originalText = btn.innerText;
        btn.innerText = "â³ ë“±ë¡ ì¤‘...";

        let fd = new FormData();
        fd.append("sheetType", "rp"); fd.append("uid", u); fd.append("userName", n);
        fd.append("rpType", document.getElementById('r-type').value); fd.append("result", selectedRes);
        
        fetch(SCRIPT_URL, { method: 'POST', body: fd, mode: 'no-cors' })
        .then(() => alert("âœ… RP ê¸°ë¡ ì™„ë£Œ!"))
        .catch(e => alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message))
        .finally(() => {
            btn.disabled = false;
            btn.innerText = originalText;
        });
    }

    function submitFine() {
        const su = document.getElementById('f-sus-uid').value, sn = document.getElementById('f-sus-name').value;
        const btn = document.getElementById('submit-fine-btn');
        if(!su || !sn) return alert("ë²”ì£„ì ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");

        btn.disabled = true;
        const originalText = btn.innerText;
        btn.innerText = "â³ ë“±ë¡ ì¤‘...";

        let items = []; document.querySelectorAll('.calc-check:checked').forEach(c => items.push(c.parentElement.innerText.split('$')[0].trim()));
        const bail = document.getElementById('f-bail-time').value; if(bail > 0) items.push(`ë³´ì„ê¸ˆ(${bail}ë¶„ ê°ë©´)`);
        
        let fd = new FormData();
        fd.append("sheetType", "fine"); fd.append("suspectUid", su); fd.append("suspectName", sn);
        fd.append("policeUid", localStorage.getItem('myUid')); fd.append("policeName", localStorage.getItem('myName'));
        fd.append("items", items.join(", ")); fd.append("totalFine", document.getElementById('disp-money').innerText); fd.append("totalTime", document.getElementById('disp-time').innerText);
        
        fetch(SCRIPT_URL, { method: 'POST', body: fd, mode: 'no-cors' })
        .then(() => { 
          alert("âœ… ë²Œê¸ˆ ì‹œíŠ¸ ë“±ë¡ ì™„ë£Œ!"); 
          resetCalc(); 
          document.getElementById('f-sus-uid').value=""; 
          document.getElementById('f-sus-name').value=""; 
        })
        .catch(e => alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message))
        .finally(() => {
            btn.disabled = false;
            btn.innerText = originalText;
        });
    }

    function handleCommute() {
        const u = localStorage.getItem('myUid'), n = localStorage.getItem('myName');
        const btn = document.getElementById('c-btn');
        if(!u || !n) return alert("ê³ ë²ˆê³¼ ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”.");
        
        const isWorking = localStorage.getItem('isWorking') === 'true';
        const type = isWorking ? "í‡´ê·¼" : "ì¶œê·¼";
        
        btn.disabled = true;
        btn.innerText = `â³ ${type} ì²˜ë¦¬ ì¤‘...`;

        let fd = new FormData();
        fd.append("sheetType", "commute"); fd.append("commuteAction", type); fd.append("uid", u); fd.append("userName", n);
        
        fetch(SCRIPT_URL, { method: 'POST', body: fd, mode: 'no-cors' })
        .then(() => { 
          localStorage.setItem('isWorking', !isWorking); 
          alert(`âœ… ${type} ì™„ë£Œ!`); 
          location.reload(); 
        })
        .catch(e => {
          alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message);
            btn.disabled = false;
            btn.innerText = isWorking ? "ğŸ  í‡´ê·¼í•˜ê¸°" : "ğŸ¢ ì¶œê·¼í•˜ê¸°";
        });
    }

    function resetAllData() {
        if(confirm("ì •ë§ë¡œ ëª¨ë“  ì‚¬ìš©ì ì„¤ì •(ì´ë¦„, ê³ ë²ˆ, ê·¼ë¬´ ìƒíƒœ ë“±)ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")) {
            localStorage.clear();
            alert("ëª¨ë“  ì„¤ì •ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
            location.reload();
        }
    }

    function setResult(v) { 
      selectedRes = v; 
      document.getElementById('box-win').className = (v==='ìŠ¹ë¦¬'?'radio-box active-win':'radio-box'); 
      document.getElementById('box-draw').className = (v==='ë¬´ìŠ¹ë¶€'?'radio-box active-draw':'radio-box'); 
      document.getElementById('box-lose').className = (v==='íŒ¨ë°°'?'radio-box active-lose':'radio-box'); 
    }
    function toggleTheme() { const isD = document.body.getAttribute('data-theme') === 'dark'; document.body.setAttribute('data-theme', isD ? 'light' : 'dark'); localStorage.setItem('theme', isD ? 'light' : 'dark'); }
    function copyNotice() {
      const text = document.getElementById('notice-preview').value;

      const fallbackCopy = () => {
        const temp = document.createElement('textarea');
        temp.value = text;
        document.body.appendChild(temp);
        temp.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(temp);
        if(!ok) throw new Error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨');
      };

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text)
        .then(()=>alert("ë³µì‚¬ì™„ë£Œ"))
        .catch(() => { fallbackCopy(); alert("ë³µì‚¬ì™„ë£Œ"); });
      } else {
        try { fallbackCopy(); alert("ë³µì‚¬ì™„ë£Œ"); }
        catch(e) { alert("ì˜¤ë¥˜ ë°œìƒ: " + e.message); }
      }
    }
    
    let currentWeekOffset = 0;
    let weeklyData = null;

    function getWeekRange(offset = 0) {
      const now = new Date();
      const day = now.getDay();
      const diff = (day === 0 ? -6 : 1) - day;
      const monday = new Date(now);
      monday.setDate(now.getDate() + diff + (offset * 7));
      monday.setHours(0, 0, 0, 0);
      
      const sunday = new Date(monday);
      sunday.setDate(monday.getDate() + 6);
      sunday.setHours(23, 59, 59, 999);
      
      return { monday, sunday };
    }

    function formatDate(date) {
      return `${date.getMonth() + 1}/${date.getDate()}`;
    }

    async function loadWeeklyStats() {
      try {
        document.getElementById('loading-message').style.display = 'block';
        document.getElementById('stats-container').style.display = 'none';
        
        // ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©: CORS ì˜¤ë¥˜ ë°œìƒ ì‹œ ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©
        try {
          const response = await fetch(SCRIPT_URL + '?type=weeklyStats');
          if (!response.ok) throw new Error('Network response was not ok');
          const data = await response.json();
          weeklyData = data;
        } catch(fetchError) {
          console.warn('ì£¼ê°„ í†µê³„ ë¡œë“œ ì‹¤íŒ¨ (CORS). ë¡œì»¬ í…ŒìŠ¤íŠ¸ ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤.', fetchError);
          // ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ë°ì´í„°
          weeklyData = {
            commute: [
              ['ê³ ìœ ë²ˆí˜¸', 'ì´ë¦„', 'ì¶œê·¼ì‹œê°„', 'í‡´ê·¼ì‹œê°„', 'ê·¼ë¬´ì‹œê°„'],
              // ìƒ˜í”Œ ë°ì´í„°ëŠ” ì‹¤ì œ ë°°í¬ ì‹œ ì„œë²„ì—ì„œ ê°€ì ¸ì˜´
            ],
            rp: [
              ['ë‚ ì§œ', 'ê³ ìœ ë²ˆí˜¸', 'ì´ë¦„', 'RPì¢…ë¥˜', 'ê²°ê³¼']
            ],
            fine: [
              ['ë‚ ì§œ', 'ë²”ì£„ìê³ ë²ˆ', 'ë²”ì£„ìì´ë¦„', 'ê²½ì°°ê³ ë²ˆ', 'ê²½ì°°ì´ë¦„', 'ì£„ëª©', 'ì´ë²Œê¸ˆ', 'ì´êµ¬ê¸ˆì‹œê°„']
            ]
          };
          document.getElementById('loading-message').innerHTML = 
            'âš ï¸ ë¡œì»¬ í…ŒìŠ¤íŠ¸ ëª¨ë“œ<br><small style="color: var(--text-sub);">ì‹¤ì œ ë°ì´í„°ëŠ” ë°°í¬ í›„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤</small>';
        }
        
        displayWeeklyStats();
      } catch(e) {
        document.getElementById('loading-message').innerText = 'ë°ì´í„° ë¡œë”© ì‹¤íŒ¨: ' + e.message;
      }
    }

    function formatDuration(totalSeconds) {
      const sec = Math.max(0, Math.floor(totalSeconds || 0));
      const h = String(Math.floor(sec / 3600)).padStart(2, '0');
      const m = String(Math.floor((sec % 3600) / 60)).padStart(2, '0');
      const s = String(sec % 60).padStart(2, '0');
      return `${h}:${m}:${s}`;
    }

    function displayWeeklyStats() {
      if(!weeklyData) return;
      
      const { monday, sunday } = getWeekRange(currentWeekOffset);
      document.getElementById('week-display').innerText = `${formatDate(monday)} ~ ${formatDate(sunday)}`;
      
      const userStats = {};
      
      // ì¶œí‡´ê·¼ ë°ì´í„° ì²˜ë¦¬ (ì´ ê·¼ë¬´ì‹œê°„)
      weeklyData.commute.forEach((row, idx) => {
        if(idx === 0) return; // í—¤ë”
        const [uid, name, startTime, endTime, durationRaw] = row;
        if(!uid || !startTime) return;
        
        const startDate = new Date(startTime);
        if(startDate >= monday && startDate <= sunday) {
          if(!userStats[uid]) userStats[uid] = { uid, name, workTime: 0, rpWin: 0, rpTotal: 0, fine: 0 };

          // durationì´ ìˆ«ì(0~1) ë˜ëŠ” 24ì‹œê°„ í˜•ì‹ ë¬¸ìì—´("HH:MM"/"HH:MM:SS")ì¼ ë•Œ ì²˜ë¦¬
          let seconds = 0;
          if(typeof durationRaw === 'number') {
            seconds = durationRaw < 1 ? durationRaw * 24 * 60 * 60 : durationRaw * 60; // ì†Œìˆ˜ë©´ ì¼(day) ë‹¨ìœ„, ì•„ë‹ˆë©´ ë¶„ ë‹¨ìœ„ë¡œ ê°€ì •
          } else if(typeof durationRaw === 'string' && durationRaw.includes(':')) {
            const parts = durationRaw.split(':').map(Number);
            if(parts.length >= 2 && parts.every(n => !Number.isNaN(n))) {
              const [h, m, s = 0] = parts;
              seconds = h * 3600 + m * 60 + s;
            }
          }

          userStats[uid].workTime += seconds;
        }
      });
      
      // RPê¸°ë¡ ë°ì´í„° ì²˜ë¦¬
      weeklyData.rp.forEach((row, idx) => {
        if(idx === 0) return;
        const [date, uid, name, type, result] = row;
        if(!uid || !date) return;
        
        const rpDate = new Date(date);
        if(rpDate >= monday && rpDate <= sunday) {
          if(!userStats[uid]) userStats[uid] = { uid, name, workTime: 0, rpWin: 0, rpTotal: 0, fine: 0 };
          userStats[uid].rpTotal++;
          if(result === 'ìŠ¹ë¦¬') userStats[uid].rpWin++;
        }
      });
      
      // ë²Œê¸ˆ ë°ì´í„° ì²˜ë¦¬
      weeklyData.fine.forEach((row, idx) => {
        if(idx === 0) return;
        const [date, suspectUid, suspectName, policeUid, policeName, items, totalFine, totalTime] = row;
        if(!policeUid || !date) return;
        
        const fineDate = new Date(date);
        if(fineDate >= monday && fineDate <= sunday) {
          if(!userStats[policeUid]) userStats[policeUid] = { uid: policeUid, name: policeName, workTime: 0, rpWin: 0, rpTotal: 0, fine: 0 };
          const fineAmount = typeof totalFine === 'string' ? parseInt(totalFine.replace(/[^0-9]/g, '')) : totalFine;
          userStats[policeUid].fine += fineAmount || 0;
        }
      });
      
      // í…Œì´ë¸” ë Œë”ë§
      const tbody = document.getElementById('stats-tbody');
      tbody.innerHTML = '';
      
      const users = Object.values(userStats).sort((a, b) => b.workTime - a.workTime);
      
      if(users.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="padding: 40px; color: var(--text-sub);">í•´ë‹¹ ê¸°ê°„ì— ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
      } else {
        users.forEach(user => {
          const workTimeStr = formatDuration(user.workTime);
          
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${user.uid}</td>
            <td>${user.name}</td>
            <td>${workTimeStr}</td>
            <td>${user.rpWin}</td>
            <td>${user.rpTotal}</td>
            <td>$${user.fine.toLocaleString()}</td>
          `;
          tbody.appendChild(row);
        });
      }
      
      document.getElementById('loading-message').style.display = 'none';
      document.getElementById('stats-container').style.display = 'block';
    }

    function changeWeek(offset) {
      currentWeekOffset += offset;
      displayWeeklyStats();
    }

    window.onload = () => {
        const u = localStorage.getItem('myUid') || "", n = localStorage.getItem('myName') || "";
        document.getElementById('c-uid').value = u; document.getElementById('c-name').value = n;
        if(localStorage.getItem('isWorking') === 'true') { document.getElementById('c-btn').innerText = "ğŸ  í‡´ê·¼í•˜ê¸°"; document.getElementById('c-btn').className = "commute-btn btn-off"; }
        
        // í”¼í¬ ëª¨ë“œ ìƒíƒœ ë³µì›
        if(localStorage.getItem('isPeakMode') === 'true') {
          isPeakMode = true;
          const btn = document.getElementById('c-peak-btn');
          btn.innerText = 'âš¡ í”¼í¬ ON';
          btn.style.background = 'var(--accent-red)';
        }
        
        if(localStorage.getItem('theme')==='dark') document.body.setAttribute('data-theme', 'dark');
        syncMyInfo();
        switchPage('page-record', document.querySelector('.nav-btn'));
    };
  </script>
</body>
</html>
